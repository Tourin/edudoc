/**
 *                                                        ____   _____
 *  Dynarch Calendar -- JSCal2, version 1.9               \  /_  /   /
 *  Built at 2013/03/04 09:35 GMT                          \  / /   /
 *                                                          \/ /_  /
 *  (c) Dynarch.com 2009-2012                                \  / /
 *  All rights reserved.                                       / /
 *  Visit www.dynarch.com/projects/calendar for details        \/
 *
 */
Calendar=function(){function aU(d){var f,b,c;d=d||{},this.args=d=az(d,{animation:!aI,cont:null,bottomBar:!0,date:!0,fdow:bg("fdow"),min:null,max:null,reverseWheel:!1,selection:[],selectionType:aU.SEL_SINGLE,weekNumbers:!1,align:"Bl/ / /T/r",inputField:null,trigger:null,dateFormat:"%Y-%m-%d",multiCtrl:!0,fixed:!1,opacity:aK?1:3,titleFormat:"%b %Y",showTime:!1,timePos:"right",time:!0,minuteStep:5,noScroll:!1,disabled:aG,checkRange:!1,dateInfo:aG,onChange:aG,onSelect:aG,onTimeChange:aG,onFocus:aG,onBlur:aG,onClose:aG}),this.handlers={},f=this,b=new Date,d.min=a3(d.min),d.max=a3(d.max),d.date===!0&&(d.date=b),d.time===!0&&(d.time=b.getHours()*100+Math.floor(b.getMinutes()/d.minuteStep)*d.minuteStep),this.date=a3(d.date),this.time=d.time,this.fdow=d.fdow,aX("onChange onSelect onTimeChange onFocus onBlur onClose".split(/\s+/),function(g){var e=d[g];e instanceof Array||(e=[e]),f.handlers[g]=e}),this.selection=new aU.Selection(d.selection,d.selectionType,aC,this),c=a2(this),d.cont&&au(d.cont).appendChild(c),d.trigger&&this.manageFields(d.trigger,d.inputField,d.dateFormat)}function a9(c){var d,f=["<table",am,"><tr>"],b=0;for(c.args.weekNumbers&&f.push("<td><div class='DynarchCalendar-weekNumber'>",bg("wk"),"</div></td>");7>b;){d=(b+++c.fdow)%7,f.push("<td><div",bg("weekend").indexOf(d)<0?">":" class='DynarchCalendar-weekend'>",bg("sdn")[d],"</div></td>")}return f.push("</tr></table>"),f.join("")}function a0(q,K,C){var N,x,G,z,B,F,M,H,k,L,J,b,E,A,I,j,w;for(K=K||q.date,C=C||q.fdow,K=new Date(K.getFullYear(),K.getMonth(),K.getDate(),12,0,0,0),N=K.getMonth(),x=[],G=0,z=q.args.weekNumbers,K.setDate(1),B=(K.getDay()-C)%7,0>B&&(B+=7),K.setDate(0-B),K.setDate(K.getDate()+1),F=new Date,M=F.getDate(),H=F.getMonth(),k=F.getFullYear(),x[G++]="<table class='DynarchCalendar-bodyTable'"+am+">",L=0;6>L;++L){for(x[G++]="<tr class='DynarchCalendar-week",0==L&&(x[G++]=" DynarchCalendar-first-row"),5==L&&(x[G++]=" DynarchCalendar-last-row"),x[G++]="'>",z&&(x[G++]="<td class='DynarchCalendar-first-col'><div class='DynarchCalendar-weekNumber'>"+aj(K)+"</div></td>"),J=0;7>J;++J){b=K.getDate(),E=K.getMonth(),A=K.getFullYear(),I=10000*A+100*(E+1)+b,j=q.selection.isSelected(I),w=q.isDisabled(K),x[G++]="<td class='",0!=J||z||(x[G++]=" DynarchCalendar-first-col"),0==J&&0==L&&(q._firstDateVisible=I),6==J&&(x[G++]=" DynarchCalendar-last-col",5==L&&(q._lastDateVisible=I)),j&&(x[G++]=" DynarchCalendar-td-selected"),x[G++]="'><div dyc-type='date' unselectable='on' dyc-date='"+I+"' ",w&&(x[G++]="disabled='1' "),x[G++]="class='DynarchCalendar-day",bg("weekend").indexOf(K.getDay())<0||(x[G++]=" DynarchCalendar-weekend"),E!=N&&(x[G++]=" DynarchCalendar-day-othermonth"),b==M&&E==H&&A==k&&(x[G++]=" DynarchCalendar-day-today"),w&&(x[G++]=" DynarchCalendar-day-disabled"),j&&(x[G++]=" DynarchCalendar-day-selected"),w=q.args.dateInfo(K),w&&w.klass&&(x[G++]=" "+w.klass),x[G++]="'>"+b+"</div></td>",K=new Date(A,E,b+1,12,0,0,0)}x[G++]="</tr>"}return x[G++]="</table>",x.join("")}function be(a){var b=["<table class='DynarchCalendar-topCont'",am,"><tr><td>","<div class='DynarchCalendar'>",aK?"<a class='DynarchCalendar-focusLink' href='#'></a>":"<button class='DynarchCalendar-focusLink'></button>","<div class='DynarchCalendar-topBar'>","<div dyc-type='nav' dyc-btn='-Y' dyc-cls='hover-navBtn,pressed-navBtn' ","class='DynarchCalendar-navBtn DynarchCalendar-prevYear'><div></div></div>","<div dyc-type='nav' dyc-btn='+Y' dyc-cls='hover-navBtn,pressed-navBtn' ","class='DynarchCalendar-navBtn DynarchCalendar-nextYear'><div></div></div>","<div dyc-type='nav' dyc-btn='-M' dyc-cls='hover-navBtn,pressed-navBtn' ","class='DynarchCalendar-navBtn DynarchCalendar-prevMonth'><div></div></div>","<div dyc-type='nav' dyc-btn='+M' dyc-cls='hover-navBtn,pressed-navBtn' ","class='DynarchCalendar-navBtn DynarchCalendar-nextMonth'><div></div></div>","<table class='DynarchCalendar-titleCont'",am,"><tr><td>","<div dyc-type='title' dyc-btn='menu' dyc-cls='hover-title,pressed-title' class='DynarchCalendar-title'>",aV(a),"</div></td></tr></table>","<div class='DynarchCalendar-dayNames'>",a9(a),"</div>","</div>","<div class='DynarchCalendar-body'></div>"];return(a.args.bottomBar||a.args.showTime)&&b.push("<div class='DynarchCalendar-bottomBar'>",aZ(a),"</div>"),b.push("<div class='DynarchCalendar-menu' style='display: none'>",a5(a),"</div>","<div class='DynarchCalendar-tooltip'></div>","</div>","</td></tr></table>"),b.join("")}function aV(a){return"<div unselectable='on'>"+ak(a.date,a.args.titleFormat)+"</div>"}function a5(d){for(var g,h=["<table height='100%'",am,"><tr><td>","<table style='margin-top: 1.5em'",am,">","<tr><td colspan='3'><input dyc-btn='year' class='DynarchCalendar-menu-year' size='6' value='",d.date.getFullYear(),"' /></td></tr>","<tr><td><div dyc-type='menubtn' dyc-cls='hover-navBtn,pressed-navBtn' dyc-btn='today'>",bg("goToday"),"</div></td></tr>","</table>","<p class='DynarchCalendar-menu-sep'>&nbsp;</p>","<table class='DynarchCalendar-menu-mtable'",am,">"],b=bg("smn"),f=0,c=h.length;12>f;){for(h[c++]="<tr>",g=4;--g>0;){h[c++]="<td><div dyc-type='menubtn' dyc-cls='hover-navBtn,pressed-navBtn' dyc-btn='m"+f+"' class='DynarchCalendar-menu-month'>"+b[f++]+"</div></td>"}h[c++]="</tr>"}return h[c++]="</table></td></tr></table>",h.join("")}function aW(a,b){b.push("<table class='DynarchCalendar-time'"+am+"><tr>","<td rowspan='2'><div dyc-type='time-hour' dyc-cls='hover-time,pressed-time' class='DynarchCalendar-time-hour'></div></td>","<td dyc-type='time-hour+' dyc-cls='hover-time,pressed-time' class='DynarchCalendar-time-up'></td>","<td rowspan='2' class='DynarchCalendar-time-sep'></td>","<td rowspan='2'><div dyc-type='time-min' dyc-cls='hover-time,pressed-time' class='DynarchCalendar-time-minute'></div></td>","<td dyc-type='time-min+' dyc-cls='hover-time,pressed-time' class='DynarchCalendar-time-up'></td>"),a.args.showTime==12&&b.push("<td rowspan='2' class='DynarchCalendar-time-sep'></td>","<td rowspan='2'><div class='DynarchCalendar-time-am' dyc-type='time-am' dyc-cls='hover-time,pressed-time'></div></td>"),b.push("</tr><tr>","<td dyc-type='time-hour-' dyc-cls='hover-time,pressed-time' class='DynarchCalendar-time-down'></td>","<td dyc-type='time-min-' dyc-cls='hover-time,pressed-time' class='DynarchCalendar-time-down'></td>","</tr></table>")}function aZ(c){function d(){b.showTime&&(f.push("<td>"),aW(c,f),f.push("</td>"))}var f=[],b=c.args;return f.push("<table",am," style='width:100%'><tr>"),b.timePos=="left"&&d(),b.bottomBar&&(f.push("<td>"),f.push("<table",am,"><tr><td>","<div dyc-btn='today' dyc-cls='hover-bottomBar-today,pressed-bottomBar-today' dyc-type='bottomBar-today' ","class='DynarchCalendar-bottomBar-today'>",bg("today"),"</div>","</td></tr></table>"),f.push("</td>")),b.timePos=="right"&&d(),f.push("</tr></table>"),f.join("")}function a2(a){var c=ah("div"),d=a.els={},b={mousedown:ao(a1,a,!0),mouseup:ao(a1,a,!1),mouseover:ao(aB,a,!0),mouseout:ao(aB,a,!1),keypress:ao(aQ,a)};return a.args.noScroll||(b[bf?"DOMMouseScroll":"mousewheel"]=ao(bc,a)),aK&&(b.dblclick=b.mousedown,b.keydown=b.keypress),c.innerHTML=be(a),ag(c.firstChild,function(f){var g=ab[f.className];g&&(d[g]=f),aK&&f.setAttribute("unselectable","on")}),aE(d.main,b),aE([d.focusLink,d.yearInput],a._focusEvents={focus:ao(bb,a),blur:ao(aT,a)}),a.moveTo(a.date,!1),a.setTime(null,!0),d.topCont}function bb(){this._bluringTimeout&&clearTimeout(this._bluringTimeout),this.focused=!0,an(this.els.main,"DynarchCalendar-focused"),this.callHooks("onFocus",this)}function a6(){this.focused=!1,ac(this.els.main,"DynarchCalendar-focused"),this._menuVisible&&aN(this,!1),this.args.cont||this.hide(),this.callHooks("onBlur",this)}function aT(){this._bluringTimeout=setTimeout(ao(a6,this),50)}function ba(a){switch(a){case"time-hour+":this.setHours(this.getHours()+1);break;case"time-hour-":this.setHours(this.getHours()-1);break;case"time-min+":this.setMinutes(this.getMinutes()+this.args.minuteStep);break;case"time-min-":this.setMinutes(this.getMinutes()-this.args.minuteStep);break;default:return}}function a8(c,d,f){this._bodyAnim&&this._bodyAnim.stop();var b;if(0!=d){switch(b=new Date(c.date),b.setDate(1),d){case"-Y":case -2:b.setFullYear(b.getFullYear()-1);break;case"+Y":case 2:b.setFullYear(b.getFullYear()+1);break;case"-M":case -1:b.setMonth(b.getMonth()-1);break;case"+M":case 1:b.setMonth(b.getMonth()+1)}}else{b=new Date}return c.moveTo(b,!f)}function aN(c,d){var f,b;c._menuVisible=d,al(d,c.els.title,"DynarchCalendar-pressed-title"),f=c.els.menu,aI&&(f.style.height=c.els.main.offsetHeight+"px"),c.args.animation?(c._menuAnim&&c._menuAnim.stop(),b=c.els.main.offsetHeight,aI&&(f.style.width=c.els.topBar.offsetWidth+"px"),d&&(f.firstChild.style.marginTop=-b+"px",c.args.opacity>0&&aH(f,0),a4(f,!0)),c._menuAnim=at({onUpdate:function(e,a){f.firstChild.style.marginTop=a(aA.accel_b(e),-b,0,!d)+"px",c.args.opacity>0&&aH(f,a(aA.accel_b(e),0,0.85,!d))},onStop:function(){c.args.opacity>0&&aH(f,0.85),f.firstChild.style.marginTop="",c._menuAnim=null,d||(a4(f,!1),c.focused&&c.focus())}})):(a4(f,d),c.focused&&c.focus())}function a1(m,f){var q,v,j,b,d,g,p,k,t;f=f||window.event,q=a7(f),q&&!q.getAttribute("disabled")&&(j=q.getAttribute("dyc-btn"),b=q.getAttribute("dyc-type"),d=q.getAttribute("dyc-date"),g=this.selection,p={mouseover:ap,mousemove:ap,mouseup:function(){var a=q.getAttribute("dyc-cls");a&&ac(q,aS(a,1)),clearTimeout(v),ay(document,p,!0),p=null}},m?(setTimeout(ao(this.focus,this),1),k=q.getAttribute("dyc-cls"),k&&an(q,aS(k,1)),"menu"==j?this.toggleMenu():q&&/^[+-][MY]$/.test(j)?a8(this,j)?(t=ao(function(){a8(this,j,!0)?v=setTimeout(t,40):(p.mouseup(),a8(this,j))},this),v=setTimeout(t,350),aE(document,p,!0)):p.mouseup():"year"==j?(this.els.yearInput.focus(),this.els.yearInput.select()):"time-am"==b?aE(document,p,!0):/^time/.test(b)?(t=ao(function(a){ba.call(this,a),v=setTimeout(t,100)},this,b),ba.call(this,b),v=setTimeout(t,350),aE(document,p,!0)):(d&&g.type&&(g.type==aU.SEL_MULTIPLE?f.shiftKey&&this._selRangeStart?g.selectRange(this._selRangeStart,d):(f.ctrlKey||g.isSelected(d)||!this.args.multiCtrl||g.clear(!0),g.set(d,!0),this._selRangeStart=d):(g.set(d),this.moveTo(aF(d),2)),q=this._getDateDiv(d),aB.call(this,!0,{target:q})),aE(document,p,!0)),aK&&p&&/dbl/i.test(f.type)&&p.mouseup(),this.args.fixed||!/^(DynarchCalendar-(topBar|bottomBar|weekend|weekNumber|menu(-sep)?))?$/.test(q.className)||this.args.cont||(p.mousemove=ao(aY,this),this._mouseDiff=aM(f,ax(this.els.topCont)),aE(document,p,!0))):"today"==j?(this._menuVisible||g.type!=aU.SEL_SINGLE||g.set(new Date),this.moveTo(new Date,!0),aN(this,!1)):/^m([0-9]+)/.test(j)?(d=new Date(this.date),d.setDate(1),d.setMonth(RegExp.$1),d.setFullYear(this._getInputYear()),this.moveTo(d,!0),aN(this,!1)):"time-am"==b&&this.setHours(this.getHours()+12),aK||ap(f))}function aY(a){a=a||window.event;var b=this.els.topCont.style,c=aM(a,this._mouseDiff);b.left=c.x+"px",b.top=c.y+"px"}function a7(a){for(var b=a.target||a.srcElement,c=b;b&&b.getAttribute&&!b.getAttribute("dyc-type");){b=b.parentNode}return b.getAttribute&&b||c}function aS(a,b){return"DynarchCalendar-"+a.split(/,/)[b]}function aB(c,f){var g,b,d;f=f||window.event,g=a7(f),g&&(b=g.getAttribute("dyc-type"),b&&!g.getAttribute("disabled")&&(c&&this._bodyAnim&&"date"==b||(d=g.getAttribute("dyc-cls"),d=d?aS(d,0):"DynarchCalendar-hover-"+b,("date"!=b||this.selection.type)&&al(c,g,d),"date"==b&&(al(c,g.parentNode.parentNode,"DynarchCalendar-hover-week"),this._showTooltip(g.getAttribute("dyc-date"))),/^time-hour/.test(b)&&al(c,this.els.timeHour,"DynarchCalendar-hover-time"),/^time-min/.test(b)&&al(c,this.els.timeMinute,"DynarchCalendar-hover-time"),ac(this._getDateDiv(this._lastHoverDate),"DynarchCalendar-hover-date"),this._lastHoverDate=null))),c||this._showTooltip()}function bc(c){var f,g,b,d;if(c=c||window.event,f=a7(c)){if(g=f.getAttribute("dyc-btn"),b=f.getAttribute("dyc-type"),d=c.wheelDelta?c.wheelDelta/120:-c.detail/3,d=0>d?-1:d>0?1:0,this.args.reverseWheel&&(d=-d),/^(time-(hour|min))/.test(b)){switch(RegExp.$1){case"time-hour":this.setHours(this.getHours()+d);break;case"time-min":this.setMinutes(this.getMinutes()+this.args.minuteStep*d)}ap(c)}else{/Y/i.test(g)&&(d*=2),a8(this,-d),ap(c)}}}function aC(){var a,b,c;this.refresh(),a=this.inputField,b=this.selection,a&&(c=b.print(this.dateFormat),/input|textarea/i.test(a.tagName)?a.value=c:a.innerHTML=c),this.callHooks("onSelect",this,b)}function aQ(w){var j,z,B,t,b,g,q,y,v,A,x,k,f;if(!this._menuAnim){if(w=w||window.event,j=w.target||w.srcElement,z=j.getAttribute("dyc-btn"),B=w.keyCode,t=w.charCode||B,b=bd[B],"year"==z&&13==B){return g=new Date(this.date),g.setDate(1),g.setFullYear(this._getInputYear()),this.moveTo(g,!0),aN(this,!1),ap(w)}if(this._menuVisible){if(27==B){return aN(this,!1),ap(w)}}else{if(w.ctrlKey||(b=null),null!=b||w.ctrlKey||(b=aa[B]),36==B&&(b=0),null!=b){return a8(this,b),ap(w)}if(t=String.fromCharCode(t).toLowerCase(),q=this.els.yearInput,y=this.selection," "==t){return aN(this,!0),this.focus(),q.focus(),q.select(),ap(w)}if(t>="0"&&"9">=t){return aN(this,!0),this.focus(),q.value=t,q.focus(),ap(w)}for(A=bg("mn"),x=w.shiftKey?-1:this.date.getMonth(),k=0;++k<12;){if(v=A[(x+k)%12].toLowerCase(),v.indexOf(t)==0){return g=new Date(this.date),g.setDate(1),g.setMonth((x+k)%12),this.moveTo(g,!0),ap(w)}}if(B>=37&&40>=B){if(g=this._lastHoverDate,g||y.isEmpty()||(g=39>B?y.getFirstDate():y.getLastDate(),(g<this._firstDateVisible||g>this._lastDateVisible)&&(g=null)),g){for(f=g,g=aF(g),x=100;x-->0;){switch(B){case 37:g.setDate(g.getDate()-1);break;case 38:g.setDate(g.getDate()-7);break;case 39:g.setDate(g.getDate()+1);break;case 40:g.setDate(g.getDate()+7)}if(!this.isDisabled(g)){break}}g=ar(g),(g<this._firstDateVisible||g>this._lastDateVisible)&&this.moveTo(g)}else{g=39>B?this._lastDateVisible:this._firstDateVisible}return ac(this._getDateDiv(f),an(this._getDateDiv(g),"DynarchCalendar-hover-date")),this._lastHoverDate=g,ap(w)}if(13==B&&this._lastHoverDate){return y.type==aU.SEL_MULTIPLE&&(w.shiftKey||w.ctrlKey)?(w.shiftKey&&this._selRangeStart&&(y.clear(!0),y.selectRange(this._selRangeStart,this._lastHoverDate)),w.ctrlKey&&y.set(this._selRangeStart=this._lastHoverDate,!0)):y.reset(this._selRangeStart=this._lastHoverDate),ap(w)}27!=B||this.args.cont||this.hide()}}}function aq(a,b){return a.replace(/\$\{([^:\}]+)(:[^\}]+)?\}/g,function(e,g,c){var f,d=b[g];return c&&(f=c.substr(1).split(/\s*\|\s*/),d=(d<f.length?f[d]:f[f.length-1]).replace(/##?/g,function(h){return h.length==2?"#":d})),d})}function bg(a,b){var c=aD.__.data[a];return b&&"string"==typeof c&&(c=aq(c,b)),c}function aj(a){var b,c;return a=new Date(a.getFullYear(),a.getMonth(),a.getDate(),12,0,0),b=a.getDay(),a.setDate(a.getDate()-(b+6)%7+3),c=a.valueOf(),a.setMonth(0),a.setDate(4),Math.round((c-a.valueOf())/604800000)+1}function aP(a){var b,c;return a=new Date(a.getFullYear(),a.getMonth(),a.getDate(),12,0,0),b=new Date(a.getFullYear(),0,1,12,0,0),c=a-b,Math.floor(c/86400000)}function ar(a){return a instanceof Date?10000*a.getFullYear()+100*(a.getMonth()+1)+a.getDate():"string"==typeof a?parseInt(a,10):a}function aF(d,h,j,b,f){var c,g;return d instanceof Date||(d=parseInt(d,10),c=Math.floor(d/10000),d%=10000,g=Math.floor(d/100),d%=100,d=new Date(c,g-1,d,null==h?12:h,null==j?0:j,null==b?0:b,null==f?0:f)),d}function aw(k,h,d){var j=k.getFullYear(),m=k.getMonth(),g=k.getDate(),b=h.getFullYear(),c=h.getMonth(),f=h.getDate();return b>j?-3:j>b?3:c>m?-2:m>c?2:d?0:f>g?-1:g>f?1:0}function ak(C,v){var j,A=C.getMonth(),D=C.getDate(),m=C.getFullYear(),b=aj(C),g=C.getDay(),k=C.getHours(),x=k>=12,p=x?k-12:k,B=aP(C),w=C.getMinutes(),q=C.getSeconds(),z=/%./g;return 0===p&&(p=12),j={"%a":bg("sdn")[g],"%A":bg("dn")[g],"%b":bg("smn")[A],"%B":bg("mn")[A],"%C":1+Math.floor(m/100),"%d":10>D?"0"+D:D,"%e":D,"%H":10>k?"0"+k:k,"%I":10>p?"0"+p:p,"%j":10>B?"00"+B:100>B?"0"+B:B,"%k":k,"%l":p,"%m":9>A?"0"+(1+A):1+A,"%o":1+A,"%M":10>w?"0"+w:w,"%n":"\n","%p":x?"PM":"AM","%P":x?"pm":"am","%s":Math.floor(C.getTime()/1000),"%S":10>q?"0"+q:q,"%t":"	","%U":10>b?"0"+b:b,"%W":10>b?"0"+b:b,"%V":10>b?"0"+b:b,"%u":g+1,"%w":g,"%y":(""+m).substr(2,2),"%Y":m,"%%":"%"},v.replace(z,function(a){return j.hasOwnProperty(a)?j[a]:a})}function a3(a){if(a){if("number"==typeof a){return aF(a)}if(!(a instanceof Date)){var b=a.split(/-/);return new Date(parseInt(b[0],10),parseInt(b[1],10)-1,parseInt(b[2],10),12,0,0,0)}}return a}function av(a){function b(c){for(var d=c.length;--d>=0;){if(c[d].toLowerCase().indexOf(a)==0){return d+1}}}return/\S/.test(a)?(a=a.toLowerCase(),b(bg("smn"))||b(bg("mn"))):void 0}function az(c,d,f,b){b={};for(f in d){d.hasOwnProperty(f)&&(b[f]=d[f])}for(f in c){c.hasOwnProperty(f)&&(b[f]=c[f])}return b}function aE(c,f,g,b){var d;if(c instanceof Array){for(d=c.length;--d>=0;){aE(c[d],f,g,b)}}else{if("object"==typeof f){for(d in f){f.hasOwnProperty(d)&&aE(c,d,f[d],g)}}else{c.addEventListener?c.addEventListener(f,g,aK?!0:!!b):c.attachEvent?c.attachEvent("on"+f,g):c["on"+f]=g}}}function ay(c,f,g,b){var d;if(c instanceof Array){for(d=c.length;--d>=0;){ay(c[d],f,g)}}else{if("object"==typeof f){for(d in f){f.hasOwnProperty(d)&&ay(c,d,f[d],g)}}else{c.removeEventListener?c.removeEventListener(f,g,aK?!0:!!b):c.detachEvent?c.detachEvent("on"+f,g):c["on"+f]=null}}}function ap(a){return a=a||window.event,aK?(a.cancelBubble=!0,a.returnValue=!1):(a.preventDefault(),a.stopPropagation()),!1}function ac(d,g,h){if(d){var b,f=d.className.replace(/^\s+|\s+$/,"").split(/\x20/),c=[];for(b=f.length;b>0;){f[--b]!=g&&c.push(f[b])}h&&c.push(h),d.className=c.join(" ")}return h}function an(a,b){return ac(a,b,b)}function al(c,d,f){if(d instanceof Array){for(var b=d.length;--b>=0;){al(c,d[b],f)}}else{ac(d,f,c?f:null)}return c}function ah(c,d,f){var b=null;return b=document.createElementNS?document.createElementNS("http://www.w3.org/1999/xhtml",c):document.createElement(c),d&&(b.className=d),f&&f.appendChild(b),b}function ai(d,g){null==g&&(g=0);var h,b,f;try{h=Array.prototype.slice.call(d,g)}catch(c){for(h=Array(d.length-g),b=g,f=0;b<d.length;++b,++f){h[f]=d[b]}}return h}function ao(a,b){var c=ai(arguments,2);return void 0==b?function(){return a.apply(this,c.concat(ai(arguments)))}:function(){return a.apply(b,c.concat(ai(arguments)))}}function ag(a,b){if(!b(a)){for(var c=a.firstChild;c;c=c.nextSibling){c.nodeType==1&&ag(c,b)}}}function at(d,h,j){function b(k,l,m,i){return i?m+k*(l-m):l+k*(m-l)}function f(){h&&c(),j=0,h=setInterval(g,1000/d.fps)}function c(){h&&(clearInterval(h),h=null),d.onStop(j/d.len,b)}function g(){var a=d.len;d.onUpdate(j/a,b),j==a&&c(),++j}return d=az(d,{fps:50,len:15,onUpdate:aG,onStop:aG}),aK&&(d.len=Math.round(d.len/2)),f(),{start:f,stop:c,update:g,args:d,map:b}}function aH(a,b){return""===b?aK?a.style.filter="":a.style.opacity="":null!=b?aK?a.style.filter="alpha(opacity="+100*b+")":a.style.opacity=b:aK?/alpha\(opacity=([0-9.])+\)/.test(a.style.opacity)&&(b=parseFloat(RegExp.$1)/100):b=parseFloat(a.style.opacity),b}function a4(a,b){var c=a.style;return null!=b&&(c.display=b?"":"none"),c.display!="none"}function aM(c,d){var f=aK?c.clientX+document.body.scrollLeft:c.pageX,b=aK?c.clientY+document.body.scrollTop:c.pageY;return d&&(f-=d.x,b-=d.y),{x:f,y:b}}function ax(c){var d,f,b;if(c.getBoundingClientRect){return d=c.getBoundingClientRect(),{x:d.left-document.documentElement.clientLeft+document.body.scrollLeft,y:d.top-document.documentElement.clientTop+document.body.scrollTop}}f=0,b=0;do{f+=c.offsetLeft-c.scrollLeft,b+=c.offsetTop-c.scrollTop}while(c=c.offsetParent);return{x:f,x:b}}function ad(){var a=document.documentElement,b=document.body;return{x:a.scrollLeft||b.scrollLeft,y:a.scrollTop||b.scrollTop,w:a.clientWidth||window.innerWidth||b.clientWidth,h:a.clientHeight||window.innerHeight||b.clientHeight}}function aX(a,b,c){for(c=0;c<a.length;++c){b(a[c])}}function au(a){return"string"==typeof a&&(a=document.getElementById(a)),a}var am,ab,af,bd,aa,aA,aG,aJ=navigator.userAgent,aO=/opera/i.test(aJ),aL=/Konqueror|Safari|KHTML/i.test(aJ),aK=/msie/i.test(aJ)&&!aO&&!/mac_powerpc/i.test(aJ),aI=aK&&/msie 6/i.test(aJ),bf=/gecko/i.test(aJ)&&!aL&&!aO&&!aK,aR=aU.prototype,aD=aU.I18N={};return aU.SEL_NONE=0,aU.SEL_SINGLE=1,aU.SEL_MULTIPLE=2,aU.SEL_WEEK=3,aU.dateToInt=ar,aU.intToDate=aF,aU.printDate=ak,aU.formatString=aq,aU.i18n=bg,aU.LANG=function(a,b,c){aD.__=aD[a]={name:b,data:c}},aU.setup=function(a){return new aU(a)},aR.moveTo=function(n,I){var L,w,E,x,A,C,K,F,k,J,H,b,B,z,G,j,q=this;return n=a3(n),w=aw(n,q.date,!0),E=q.args,x=E.min&&aw(n,E.min),A=E.max&&aw(n,E.max),E.animation||(I=!1),al(null!=x&&1>=x,[q.els.navPrevMonth,q.els.navPrevYear],"DynarchCalendar-navDisabled"),al(null!=A&&A>=-1,[q.els.navNextMonth,q.els.navNextYear],"DynarchCalendar-navDisabled"),-1>x&&(n=E.min,L=1,w=0),A>1&&(n=E.max,L=2,w=0),q.date=n,q.refresh(!!I),q.callHooks("onChange",q,n,I),!I||0==w&&2==I||(q._bodyAnim&&q._bodyAnim.stop(),C=q.els.body,K=ah("div","DynarchCalendar-animBody-"+af[w],C),F=C.firstChild,aH(F)||0.7,k=L?aA.brakes:0==w?aA.shake:aA.accel_ab2,J=w*w>4,H=J?F.offsetTop:F.offsetLeft,b=K.style,B=J?C.offsetHeight:C.offsetWidth,0>w?B+=H:w>0?B=H-B:(B=Math.round(B/7),2==L&&(B=-B)),L||0==w||(z=K.cloneNode(!0),G=z.style,j=2*B,z.appendChild(F.cloneNode(!0)),G[J?"marginTop":"marginLeft"]=B+"px",C.appendChild(z)),F.style.visibility="hidden",K.innerHTML=a0(q),q._bodyAnim=at({onUpdate:function(c,d){var f,a=k(c);z&&(f=d(a,B,j)+"px"),L?b[J?"marginTop":"marginLeft"]=d(a,B,0)+"px":((J||0==w)&&(b.marginTop=d(0==w?k(c*c):a,0,B)+"px",0!=w&&(G.marginTop=f)),J&&0!=w||(b.marginLeft=d(a,0,B)+"px",0!=w&&(G.marginLeft=f))),q.args.opacity>2&&z&&(aH(z,1-a),aH(K,a))},onStop:function(){C.innerHTML=a0(q,n),q._bodyAnim=null}})),q._lastHoverDate=null,x>=-1&&1>=A},aR.isDisabled=function(a){var b=this.args;return b.min&&aw(a,b.min)<0||b.max&&aw(a,b.max)>0||b.disabled(a)},aR.toggleMenu=function(){aN(this,!this._menuVisible)},aR.refresh=function(a){var b=this.els;a||(b.body.innerHTML=a0(this)),b.title.innerHTML=aV(this),b.yearInput.value=this.date.getFullYear()},aR.redraw=function(){var a=this,b=a.els;a.refresh(),b.dayNames.innerHTML=a9(a),b.menu.innerHTML=a5(a),b.bottomBar&&(b.bottomBar.innerHTML=aZ(a)),ag(b.topCont,function(d){var c=ab[d.className];c&&(b[c]=d),d.className=="DynarchCalendar-menu-year"?(aE(d,a._focusEvents),b.yearInput=d):aK&&d.setAttribute("unselectable","on")}),a.setTime(null,!0)},aR.setLanguage=function(a){var b=aU.setLanguage(a);b&&(this.fdow=b.data.fdow,this.redraw())},aU.setLanguage=function(a){var b=aD[a];return b&&(aD.__=b),b},aR.focus=function(){try{this.els[this._menuVisible?"yearInput":"focusLink"].focus()}catch(a){}bb.call(this)},aR.blur=function(){this.els.focusLink.blur(),this.els.yearInput.blur(),a6.call(this)},aR.showAt=function(d,h,k){this._showAnim&&this._showAnim.stop(),k=k&&this.args.animation;var b=this.els.topCont,f=this,c=this.els.body.firstChild,g=c.offsetHeight,j=b.style;j.position="absolute",j.left=d+"px",j.top=h+"px",j.zIndex=10000,j.display="",k&&(c.style.marginTop=-g+"px",this.args.opacity>1&&aH(b,0),this._showAnim=at({onUpdate:function(a,i){c.style.marginTop=-i(aA.accel_b(a),g,0)+"px",f.args.opacity>1&&aH(b,a)},onStop:function(){f.args.opacity>1&&aH(b,""),f._showAnim=null}}))},aR.hide=function(){this.callHooks("onClose",this);var c=this.els.topCont,f=this,g=this.els.body.firstChild,b=g.offsetHeight,d=ax(c).y;this.args.animation?(this._showAnim&&this._showAnim.stop(),this._showAnim=at({onUpdate:function(a,e){f.args.opacity>1&&aH(c,1-a),g.style.marginTop=-e(aA.accel_b(a),0,b)+"px",c.style.top=e(aA.accel_ab(a),d,d-10)+"px"},onStop:function(){c.style.display="none",g.style.marginTop="",f.args.opacity>1&&aH(c,""),f._showAnim=null}})):c.style.display="none",this.inputField=null},aR.popup=function(k,h){function d(a){var i={x:f.x,y:f.y};return a?(/B/.test(a)&&(i.y+=k.offsetHeight),/b/.test(a)&&(i.y+=k.offsetHeight-j.y),/T/.test(a)&&(i.y-=j.y),/l/.test(a)&&(i.x-=j.x-k.offsetWidth),/L/.test(a)&&(i.x-=j.x),/R/.test(a)&&(i.x+=k.offsetWidth),/c/i.test(a)&&(i.x+=(k.offsetWidth-j.x)/2),/m/i.test(a)&&(i.y+=(k.offsetHeight-j.y)/2),i):i}var j,m,g,b,c,f;k=au(k),h||(h=this.args.align),h=h.split(/\x2f/),m=ax(k),g=this.els.topCont,b=g.style,c=ad(),b.visibility="hidden",b.display="",this.showAt(0,0),document.body.appendChild(g),j={x:g.offsetWidth,y:g.offsetHeight},f=m,f=d(h[0]),f.y<c.y&&(f.y=m.y,f=d(h[1])),f.x+j.x>c.x+c.w&&(f.x=m.x,f=d(h[2])),f.y+j.y>c.y+c.h&&(f.y=m.y,f=d(h[3])),f.x<c.x&&(f.x=m.x,f=d(h[4])),this.showAt(f.x,f.y,!0),b.visibility="",this.focus()},aR.popupForField=function(h,k,c){var f,d,g,j,b=this;k=au(k),h=au(h),b.inputField=k,b.dateFormat=c,b.selection.type==aU.SEL_SINGLE&&(f=/input|textarea/i.test(k.tagName)?k.value:k.innerText||k.textContent,f&&(d=/(^|[^%])%[bBmo]/.exec(c),g=/(^|[^%])%[de]/.exec(c),d&&g&&(j=d.index<g.index),f=Calendar.parseDate(f,j),f&&(b.selection.set(f,!1,!0),b.args.showTime&&(b.setHours(f.getHours()),b.setMinutes(f.getMinutes())),b.moveTo(f)))),b.popup(h)},aR.manageFields=function(c,d,f){var b=this;d=au(d),c=au(c),/^button$/i.test(c.tagName)&&c.setAttribute("type","button"),aE(c,"click",function(a){return b.popupForField(c,d,f),ap(a)})},aR.callHooks=function(c){for(var d=ai(arguments,1),f=this.handlers[c],b=0;b<f.length;++b){f[b].apply(this,d)}},aR.addEventListener=function(a,b){this.handlers[a].push(b)},aR.removeEventListener=function(c,d){for(var f=this.handlers[c],b=f.length;--b>=0;){f[b]===d&&f.splice(b,1)}},aR.getTime=function(){return this.time},aR.setTime=function(d,h){var k,b,f,c,g,j;this.args.showTime&&(d=null!=d?d:this.time,this.time=d,k=this.getHours(),b=this.getMinutes(),f=12>k,this.args.showTime==12&&(0==k&&(k=12),k>12&&(k-=12),this.els.timeAM.innerHTML=bg(f?"AM":"PM")),10>k&&(k="0"+k),10>b&&(b="0"+b),this.els.timeHour.innerHTML=k,this.els.timeMinute.innerHTML=b,h||(this.callHooks("onTimeChange",this,d),c=this.inputField,g=this.selection,c&&(j=g.print(this.dateFormat),/input|textarea/i.test(c.tagName)?c.value=j:c.innerHTML=j)))},aR.getHours=function(){return Math.floor(this.time/100)},aR.getMinutes=function(){return this.time%100},aR.setHours=function(a){0>a&&(a+=24),this.setTime(100*(a%24)+this.time%100)},aR.setMinutes=function(a){0>a&&(a+=60),a=Math.floor(a/this.args.minuteStep)*this.args.minuteStep,this.setTime(100*this.getHours()+a%60)},aR._getInputYear=function(){var a=parseInt(this.els.yearInput.value,10);return isNaN(a)&&(a=this.date.getFullYear()),a},aR._showTooltip=function(c){var d,f="",b=this.els.tooltip;c&&(c=aF(c),d=this.args.dateInfo(c),d&&d.tooltip&&(f="<div class='DynarchCalendar-tooltipCont'>"+ak(c,d.tooltip)+"</div>")),b.innerHTML=f},am=" align='center' cellspacing='0' cellpadding='0'",ab={"DynarchCalendar-topCont":"topCont","DynarchCalendar-focusLink":"focusLink",DynarchCalendar:"main","DynarchCalendar-topBar":"topBar","DynarchCalendar-title":"title","DynarchCalendar-dayNames":"dayNames","DynarchCalendar-body":"body","DynarchCalendar-menu":"menu","DynarchCalendar-menu-year":"yearInput","DynarchCalendar-bottomBar":"bottomBar","DynarchCalendar-tooltip":"tooltip","DynarchCalendar-time-hour":"timeHour","DynarchCalendar-time-minute":"timeMinute","DynarchCalendar-time-am":"timeAM","DynarchCalendar-navBtn DynarchCalendar-prevYear":"navPrevYear","DynarchCalendar-navBtn DynarchCalendar-nextYear":"navNextYear","DynarchCalendar-navBtn DynarchCalendar-prevMonth":"navPrevMonth","DynarchCalendar-navBtn DynarchCalendar-nextMonth":"navNextMonth"},af={"-3":"backYear","-2":"back",0:"now",2:"fwd",3:"fwdYear"},bd={37:-1,38:-2,39:1,40:2},aa={33:-1,34:1},aR._getDateDiv=function(a){var b=null;if(a){try{ag(this.els.body,function(d){if(d.getAttribute("dyc-date")==a){throw b=d}})}catch(c){}}return b},(aU.Selection=function(c,d,f,b){this.type=d,this.sel=c instanceof Array?c:[c],this.onChange=ao(f,b),this.cal=b}).prototype={get:function(){return this.type==aU.SEL_SINGLE?this.sel[0]:this.sel},isEmpty:function(){return this.sel.length==0},set:function(d,f,b){var c=this.type==aU.SEL_SINGLE;d instanceof Array?(this.sel=d,this.normalize(),b||this.onChange(this)):(d=ar(d),c||!this.isSelected(d)?(c?this.sel=[d]:this.sel.splice(this.findInsertPos(d),0,d),this.normalize(),b||this.onChange(this)):f&&this.unselect(d,b))},reset:function(){this.sel=[],this.set.apply(this,arguments)},countDays:function(){for(var d,g,h,b=0,f=this.sel,c=f.length;--c>=0;){d=f[c],d instanceof Array&&(g=aF(d[0]),h=aF(d[1]),b+=Math.round(Math.abs(h.getTime()-g.getTime())/86400000)),++b}return b},unselect:function(k,h){var d,j,m,g,b,c,f;for(k=ar(k),d=!1,m=this.sel,g=m.length;--g>=0;){j=m[g],j instanceof Array?k<j[0]||k>j[1]||(b=aF(k),c=b.getDate(),k==j[0]?(b.setDate(c+1),j[0]=ar(b),d=!0):k==j[1]?(b.setDate(c-1),j[1]=ar(b),d=!0):(f=new Date(b),f.setDate(c+1),b.setDate(c-1),m.splice(g+1,0,[ar(f),j[1]]),j[1]=ar(b),d=!0)):k==j&&(m.splice(g,1),d=!0)}d&&(this.normalize(),h||this.onChange(this))},normalize:function(){var d,h,j,b,f,c,g;for(this.sel=this.sel.sort(function(a,i){return a instanceof Array&&(a=a[0]),i instanceof Array&&(i=i[0]),a-i}),j=this.sel,b=j.length;--b>=0;){if(d=j[b],d instanceof Array){if(d[0]>d[1]){j.splice(b,1);continue}d[0]==d[1]&&(d=j[b]=d[0])}h&&(f=h,c=d instanceof Array?d[1]:d,c=aF(c),c.setDate(c.getDate()+1),c=ar(c),f>c||(g=j[b+1],d instanceof Array&&g instanceof Array?(d[1]=g[1],j.splice(b+1,1)):d instanceof Array?(d[1]=h,j.splice(b+1,1)):g instanceof Array?(g[0]=d,j.splice(b,1)):(j[b]=[d,g],j.splice(b+1,1)))),h=d instanceof Array?d[0]:d}},findInsertPos:function(c){for(var d,f=this.sel,b=f.length;--b>=0&&(d=f[b],d instanceof Array&&(d=d[0]),c<d);){}return b+1},clear:function(a){this.sel=[],a||this.onChange(this)},selectRange:function(f,g){var b,d;if(f=ar(f),g=ar(g),f>g&&(b=f,f=g,g=b),d=this.cal.args.checkRange,!d){return this._do_selectRange(f,g)}try{aX(new aU.Selection([[f,g]],aU.SEL_MULTIPLE,aG).getDates(),ao(function(a){if(this.isDisabled(a)){throw d instanceof Function&&d(a,this),"OUT"}},this.cal)),this._do_selectRange(f,g)}catch(c){}},_do_selectRange:function(a,b){this.sel.push([a,b]),this.normalize(),this.onChange(this)},isSelected:function(a){for(var b,c=this.sel.length;--c>=0;){if(b=this.sel[c],b instanceof Array&&a>=b[0]&&a<=b[1]||a==b){return !0}}return !1},getFirstDate:function(){var a=this.sel[0];return a&&a instanceof Array&&(a=a[0]),a},getLastDate:function(){if(this.sel.length>0){var a=this.sel[this.sel.length-1];return a&&a instanceof Array&&(a=a[1]),a}},print:function(d,h){var j,b=[],f=0,c=this.cal.getHours(),g=this.cal.getMinutes();for(h||(h=" -> ");f<this.sel.length;){j=this.sel[f++],j instanceof Array?b.push(ak(aF(j[0],c,g),d)+h+ak(aF(j[1],c,g),d)):b.push(ak(aF(j,c,g),d))}return b},getDates:function(c){for(var f,g,b=[],d=0;d<this.sel.length;){if(g=this.sel[d++],g instanceof Array){for(f=aF(g[0]),g=g[1];ar(f)<g;){b.push(c?ak(f,c):new Date(f)),f.setDate(f.getDate()+1)}}else{f=aF(g)}b.push(c?ak(f,c):f)}return b}},aU.isUnicodeLetter=function(a){return a.toUpperCase()!=a.toLowerCase()},aU.parseDate=function(t,j,z){var B,m,b,g,k,w,p,A,v,q,x;if(!/\S/.test(t)){return""}for(t=t.replace(/^\s+/,"").replace(/\s+$/,""),z=z||new Date,B=null,m=null,b=null,g=null,k=null,w=null,p=t.match(/([0-9]{1,2}):([0-9]{1,2})(:[0-9]{1,2})?\s*(am|pm)?/i),p&&(g=parseInt(p[1],10),k=parseInt(p[2],10),w=p[3]?parseInt(p[3].substr(1),10):0,t=t.substring(0,p.index)+t.substr(p.index+p[0].length),p[4]&&(p[4].toLowerCase()=="pm"&&12>g?g+=12:p[4].toLowerCase()!="am"||12>g||(g-=12))),A=function(){function f(){return t.charAt(u++)}function E(){return t.charAt(u)}function F(a){for(;E()&&C(E());){a+=f()}return a}function y(){for(var a="";E()&&/[0-9]/.test(E());){a+=f()}return C(E())?F(a):parseInt(a,10)}function d(a){D.push(a)}for(var e,u=0,D=[],C=aU.isUnicodeLetter;u<t.length;){e=E(),C(e)?d(F("")):/[0-9]/.test(e)?d(y()):f()}return D}(),v=[],q=0;q<A.length;++q){x=A[q],/^[0-9]{4}$/.test(x)?(B=parseInt(x,10),null==m&&null==b&&null==j&&(j=!0)):/^[0-9]{1,2}$/.test(x)?(x=parseInt(x,10),60>x?0>x||x>12?1>x||x>31||(b=x):v.push(x):B=x):null==m&&(m=av(x))}return v.length<2?v.length==1&&(null==b?b=v.shift():null==m&&(m=v.shift())):j?(null==m&&(m=v.shift()),null==b&&(b=v.shift())):(null==b&&(b=v.shift()),null==m&&(m=v.shift())),null==B&&(B=v.length>0?v.shift():z.getFullYear()),30>B?B+=2000:99>B&&(B+=1900),null==m&&(m=z.getMonth()+1),null!=B&&null!=m&&null!=b?new Date(B,m-1,b,g,k,w):null},aA={elastic_b:function(a){return 1-Math.cos(5.5*-a*Math.PI)/Math.pow(2,7*a)},magnetic:function(a){return 1-Math.cos(10.5*a*a*a*Math.PI)/Math.exp(4*a)},accel_b:function(a){return a=1-a,1-a*a*a*a},accel_a:function(a){return a*a*a},accel_ab:function(a){return a=1-a,1-Math.sin(a*a*Math.PI/2)},accel_ab2:function(a){return(a/=0.5)<1?0.5*a*a:-0.5*(--a*(a-2)-1)},brakes:function(a){return a=1-a,1-Math.sin(a*a*Math.PI)},shake:function(a){return 0.5>a?-Math.cos(11*a*Math.PI)*a*a:(a=1-a,Math.cos(11*a*Math.PI)*a*a)}},aG=Function(),aU}();
Calendar.LANG("cn","中文",{fdow:1,goToday:"今天",today:"今天",wk:"周",weekend:"0,6",AM:"AM",PM:"PM",mn:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],smn:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],dn:["日","一","二","三","四","五","六","日"],sdn:["日","一","二","三","四","五","六","日"]});
